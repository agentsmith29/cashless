<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Make Sale</title>
    <!-- Bootstrap CSS -->
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>

<div class="container mt-5">
    <h1 class="mb-4">Make a Sale</h1>

    <nav class="mb-4">
        <a href="{% url 'view_stock' %}" class="btn btn-info mr-2">View Stock</a>
        <a href="{% url 'add_product' %}" class="btn btn-primary mr-2">Add Product</a>
        <a href="{% url 'add_stock' %}" class="btn btn-secondary">Add Stock</a>
    </nav>

    <form method="post" class="border p-4 shadow-sm bg-light">
        {% csrf_token %}
        <div class="form-group">
            <label for="ean">EAN (Article Number)</label>
            <select class="form-control" id="ean" name="ean" required onchange="updatePrice()">
                <option value="" data-resell-price="0">-- Select Product --</option>
                {% for product in products %}
                <option value="{{ product.ean }}"
                        data-resell-price="{{ product.resell_price }}">
                    {{ product.name }} (EAN: {{ product.ean }}) P: {{ product.resell_price }}
                </option>
                {% endfor %}
            </select>
        </div>
        <div class="form-group">
            <label for="quantity">Quantity</label>
            <input type="number" class="form-control" id="quantity" name="quantity" required value="1" min="1">
        </div>
        <div class="form-group">
            <label for="sale_price">Price (€)</label>
            <input type="text" class="form-control" id="sale_price" name="sale_price" required>
        </div>
        <div class="form-group">
            <label for="customer">Price (€)</label>
            <input type="text" class="form-control" id="customer" name="customer" required>
        </div>
        <button type="submit" class="btn btn-success">Make Sale</button>
    </form>
</div>

<!-- JavaScript to dynamically update the price -->
<script>
    function updatePrice() {
        const eanSelect = document.getElementById('ean');
        const selectedOption = eanSelect.options[eanSelect.selectedIndex];
        const resellPrice = selectedOption.getAttribute('data-resell-price');
        document.getElementById('sell_price').value = resellPrice || 0;
    }
</script>

<!-- Bootstrap JS and dependencies -->
<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.4.4/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
</body>
</html>
